# NetworkTap Configuration File
# OnLogic FR201 Network Tap Appliance

# ── Operating Mode ───────────────────────────────────────────────
# span   = NIC1 monitors SPAN port, NIC2 is management
# bridge = Both NICs form transparent bridge, management via bridge IP
MODE=span

# ── Network Interfaces ──────────────────────────────────────────
# Auto-detected during install; override here if needed
NIC1=eth0
NIC2=eth1
BRIDGE_NAME=br0

# ── Management Network ──────────────────────────────────────────
MGMT_IP=dhcp
# Static example: MGMT_IP=192.168.1.100/24
# MGMT_GATEWAY=192.168.1.1
# MGMT_DNS=8.8.8.8

# ── Capture Settings ────────────────────────────────────────────
CAPTURE_DIR=/var/lib/networktap/captures
CAPTURE_IFACE=auto
# Rotation: new file every N seconds
CAPTURE_ROTATE_SECONDS=3600
# Max number of rotated files (0 = unlimited)
CAPTURE_FILE_LIMIT=0
# Snap length (0 = full packet)
CAPTURE_SNAPLEN=0
# BPF filter (empty = capture all)
CAPTURE_FILTER=
# Compress rotated pcaps
CAPTURE_COMPRESS=yes

# ── Retention ────────────────────────────────────────────────────
RETENTION_DAYS=7
# Minimum free disk percentage before emergency cleanup
MIN_FREE_DISK_PCT=10

# ── Suricata IDS ─────────────────────────────────────────────────
SURICATA_ENABLED=yes
SURICATA_CONFIG=/etc/suricata/suricata.yaml
SURICATA_LOG_DIR=/var/log/suricata
SURICATA_EVE_LOG=/var/log/suricata/eve.json
SURICATA_IFACE=auto

# ── Zeek IDS ─────────────────────────────────────────────────────
ZEEK_ENABLED=yes
ZEEK_LOG_DIR=/var/log/zeek
ZEEK_IFACE=auto

# ── Web Dashboard ────────────────────────────────────────────────
WEB_HOST=0.0.0.0
WEB_PORT=8443
WEB_USER=admin
WEB_PASS=networktap
# Secret key for session tokens (change in production!)
WEB_SECRET=change-me-in-production-$(hostname)-$(date +%s)

# ── TLS/HTTPS ────────────────────────────────────────────────────
# Enable HTTPS (run setup/configure_tls.sh to generate certificates)
TLS_ENABLED=no
TLS_CERT=/etc/networktap/tls/server.crt
TLS_KEY=/etc/networktap/tls/server.key

# ── Syslog Forwarding ────────────────────────────────────────────
# Forward logs to remote syslog/SIEM server
SYSLOG_ENABLED=no
SYSLOG_SERVER=
SYSLOG_PORT=514
SYSLOG_PROTOCOL=udp
# Format: syslog or json (for Splunk/Elastic)
SYSLOG_FORMAT=syslog

# ── Logging ──────────────────────────────────────────────────────
LOG_DIR=/var/log/networktap
LOG_LEVEL=INFO
