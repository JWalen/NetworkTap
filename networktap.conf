# NetworkTap Configuration File
# OnLogic FR201 Network Tap Appliance

# ── Operating Mode ───────────────────────────────────────────────
# span   = NIC1 monitors SPAN port, NIC2 is management
# bridge = Both NICs form transparent bridge, management via bridge IP
MODE=span

# ── Network Interfaces ──────────────────────────────────────────
# Auto-detected during install; override here if needed
NIC1=eth1
NIC2=eth0
BRIDGE_NAME=br0

# ── Management Network ──────────────────────────────────────────
MGMT_IP=dhcp
# Static example: MGMT_IP=192.168.1.100/24
# MGMT_GATEWAY=192.168.1.1
# MGMT_DNS=8.8.8.8

# ── Capture Settings ────────────────────────────────────────────
CAPTURE_DIR=/var/lib/networktap/captures
CAPTURE_IFACE=auto
# Rotation: new file every N seconds
CAPTURE_ROTATE_SECONDS=3600
# Max number of rotated files (0 = unlimited)
CAPTURE_FILE_LIMIT=0
# Snap length (0 = full packet)
CAPTURE_SNAPLEN=0
# BPF filter (empty = capture all)
CAPTURE_FILTER=
# Compress rotated pcaps
CAPTURE_COMPRESS=yes

# ── Retention ────────────────────────────────────────────────────
RETENTION_DAYS=7
# Minimum free disk percentage before emergency cleanup
MIN_FREE_DISK_PCT=10

# ── Suricata IDS ─────────────────────────────────────────────────
SURICATA_ENABLED=yes
SURICATA_CONFIG=/etc/suricata/suricata.yaml
SURICATA_LOG_DIR=/var/log/suricata
SURICATA_EVE_LOG=/var/log/suricata/eve.json
SURICATA_IFACE=auto

# ── Zeek IDS ─────────────────────────────────────────────────────
ZEEK_ENABLED=yes
ZEEK_LOG_DIR=/var/log/zeek
ZEEK_IFACE=auto

# ── Web Dashboard ────────────────────────────────────────────────
WEB_HOST=0.0.0.0
WEB_PORT=8443
WEB_USER=admin
WEB_PASS=networktap
# Secret key for session tokens (change in production!)
WEB_SECRET=change-me-in-production-$(hostname)-$(date +%s)

# ── TLS/HTTPS ────────────────────────────────────────────────────
# Enable HTTPS (run setup/configure_tls.sh to generate certificates)
TLS_ENABLED=no
TLS_CERT=/etc/networktap/tls/server.crt
TLS_KEY=/etc/networktap/tls/server.key

# ── Syslog Forwarding ────────────────────────────────────────────
# Forward logs to remote syslog/SIEM server
SYSLOG_ENABLED=no
SYSLOG_SERVER=
SYSLOG_PORT=514
SYSLOG_PROTOCOL=udp
# Format: syslog or json (for Splunk/Elastic)
SYSLOG_FORMAT=syslog

# ── Logging ──────────────────────────────────────────────────────
LOG_DIR=/var/log/networktap
LOG_LEVEL=INFO

# ── WiFi Capture (Monitor Mode) ──────────────────────────────────
WIFI_CAPTURE_ENABLED=yes
WIFI_CAPTURE_CHANNEL=11
WIFI_CAPTURE_MAX_SIZE_MB=100
WIFI_CAPTURE_MAX_FILES=50
WIFI_CAPTURE_FILTER=

# ── FR202 Front Panel Display ────────────────────────────────────
# Enable/disable the front panel display (FR202 only)
DISPLAY_ENABLED=yes
# Refresh interval in seconds (how often to redraw)
DISPLAY_REFRESH=5
# Backlight timeout in seconds (0 = never dim)
DISPLAY_BACKLIGHT_TIMEOUT=120
# Default page to show on boot: dashboard, network, services, alerts, system
DISPLAY_DEFAULT_PAGE=dashboard
# Enable screensaver (pulsing logo + clock) instead of just dimming backlight
DISPLAY_SCREENSAVER=yes
# Screensaver color (hex, e.g. #00d4aa, #ff6600, #3b82f6)
DISPLAY_SCREENSAVER_COLOR=#00d4aa

# ── AI Features ──────────────────────────────────────────────────
# Anomaly Detection (lightweight ML, runs continuously)
ANOMALY_DETECTION_ENABLED=yes
# Sensitivity: low, medium, high (higher = more alerts)
ANOMALY_SENSITIVITY=medium
# Check interval in seconds
ANOMALY_INTERVAL=60

# AI Assistant (Ollama + TinyLLaMA, on-demand)
AI_ASSISTANT_ENABLED=yes
# Ollama server URL (local by default)
OLLAMA_URL=http://localhost:11434
# Model to use (tinyllama is recommended for Pi)
OLLAMA_MODEL=tinyllama
